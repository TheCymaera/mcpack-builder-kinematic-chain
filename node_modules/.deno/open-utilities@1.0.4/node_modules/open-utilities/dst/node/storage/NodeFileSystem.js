import { FileSystem } from "../../core/storage/FileSystem.js";
// @ts-ignore
import { promises as fs } from "fs";
/**
 * @experimental
 */
export class NodeFileSystem extends FileSystem {
    async readFile(uri) {
        return fs.readFile(this.#filePath(uri));
    }
    async writeFile(uri, content) {
        await this.createDirectory(uri.clone().appendString(".")).catch(() => void 0);
        await fs.writeFile(this.#filePath(uri), new TextDecoder().decode(content));
    }
    async createDirectory(uri) {
        await fs.mkdir(this.#filePath(uri), { recursive: true });
    }
    #filePath(uri) {
        return decodeURI(uri.pathname);
    }
}
